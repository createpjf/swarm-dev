#!/usr/bin/env python3
"""
Swarm Agent Stack — Interactive CLI.

Usage:
  swarm                    # interactive chat (default)
  swarm configure          # full setup wizard (re-configure)
  swarm --setup            # alias for configure
  swarm run "task"         # one-shot task
  swarm status             # task board
  swarm scores             # reputation scores
  swarm doctor             # system health check
  swarm gateway            # start HTTP gateway (foreground)
  swarm agents add <name>  # add an agent to the team
"""
import os
import sys

# Always run from the project root
os.chdir(os.path.dirname(os.path.abspath(__file__)))
sys.path.insert(0, os.path.dirname(os.path.abspath(__file__)))


if __name__ == "__main__":
    from core.env_loader import load_dotenv
    load_dotenv()

    cmd = sys.argv[1] if len(sys.argv) > 1 else ""

    # Fast routes (avoid importing main module for simple commands)
    if cmd == "configure" or "--setup" in sys.argv:
        from core.onboard import run_onboard
        run_onboard()
    elif cmd == "doctor":
        from main import cmd_doctor
        cmd_doctor()
    elif cmd == "gateway":
        from main import cmd_gateway
        cmd_gateway()
    elif cmd == "" and len(sys.argv) == 1:
        from main import interactive_main
        interactive_main()
    else:
        # All other commands → argparse in main.py
        from main import main
        main()
